<!--TABLE-->
<!-- 
<table id="table" class="table table-striped table-hover table-light text-nowrap table-responsive-xl">
    <thead class="thead-dark">
        <tr>
            <th scope="col">#</th>
            <th scope="col" *ngFor="let head of displayedColumns ">{{head}}</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>

        <tr *ngFor="let emp of employees | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize ; let i = index"
            class="rows">
            <th scope="row" style="vertical-align: middle;">{{i+1+(page-1)*pageSize}}</th>
            <td *ngFor="let key of keys" style="vertical-align: middle;">{{emp[key]}}</td>
            <td style="display: table-cell; vertical-align: inherit; ">
                <button type="button" class="btn btn-outline-danger" (click)="open(deleteModal)"
                    (click)="deleteAcc=emp"><i class="fas fa-trash-alt"></i></button>
                <button type="button" class="btn btn-outline-info"><i class="far fa-edit"></i></button>
            </td>


        </tr>


    </tbody>
</table> -->


<div style="width: 95%; margin: auto; display: flex; flex-direction: column;">
    <div style="display: flex; justify-content: space-between;">
        <div style="font-size: 8vw; float: left;">
            <p style="margin: 0px;">{{tableName}}</p>
        </div>
        <div style="  align-self: flex-end;">

            <mat-form-field>
                <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
            </mat-form-field>
        </div>
    </div>


    <div class="mat-elevation-z8">

        <table multiTemplateDataRows mat-table matSort [dataSource]="dataSource">

            <ng-container *ngFor="let item of keys" matColumnDef="{{item}}">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> {{item}} </th>
                <td mat-cell *matCellDef="let element"> {{element[item]}} </td>
            </ng-container>

            <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let element" [attr.colspan]="keys.length">
                    <div class="example-element-detail" style="float: right;"
                        [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                        <button mat-button style="background-color:rgb(212, 67, 67); color: white;margin: 10px; "
                            (click)="openDeleteDialog(element[primaryKeyColumn])"><i
                                class="fas fa-trash-alt"></i></button>
                        <button mat-button style="background-color:rgb(67, 212, 127); color: white;margin: 10px; "
                            (click)="openEditDialog(element,element[primaryKeyColumn])" (click)="test(element[primaryKeyColumn])"><i
                                class="far fa-edit"></i></button>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="keys"></tr>
            <!-- <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr> -->
            <tr mat-row *matRowDef="let element; columns: keys;" class="example-element-row"
                [class.example-expanded-row]="expandedElement === element" (click)="expandedElement = element"
                (click)="$event.preventDefault()">
            </tr>
            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>

        </table>
        <div>

            <mat-paginator [length]="100" [pageSize]="10" [pageSizeOptions]="[5, 10, 20]"></mat-paginator>
        </div>

    </div>
</div>



<div>
    <ng-template #deleteModal let-modal>

        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Are you sure?</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">


            <form>
                <button type="button" class="btn btn-outline-danger" style="float: right;"
                    (click)="test(deleteAcc)">Yes, delete</button>

            </form>
        </div>


    </ng-template>
</div>



<div style="width: 90%;margin: auto;margin-top: 30px;">
    <button type="button" class="btn btn-success" style="margin: 0px;" data-toggle="modal" data-target="#addModal"
        (click)="open(addModal)" (click)="prepareNewContainer()">Add</button>

    <ng-template #addModal let-modal>
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Add new row</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">


            <form>
                <div class="form-group" *ngFor="let item of keys let i = index">
                    <div *ngIf="item != primaryKeyColumn || this.foreignKeyColumns.includes(item)">
                        <label>{{item}}</label>

                        <!--DROPDOWN SECTION-->
                        <div *ngIf="this.foreignKeyColumns.includes(item); else notDropdownBlock">
                            <!-- <div ngbDropdown>

                                <button class="btn btn-outline-dark" type="button" style="width: 100%;"
                                    ngbDropdownToggle (click)='getAvaiableRows([tableName,keys[i]])'>
                                    {{newRowContainer[i]}}
                                </button>
                                <div ngbDropdownMenu>
                                    <button ngbDropdownItem type="button" *ngFor="let foreignKey of foreignKeyElems"
                                        (click)="saveToContainer(i,foreignKey)">{{foreignKey}}</button>
                                </div>
                            </div> -->

                            <form>
                                <mat-form-field>
                                    <mat-select [(ngModel)]="newRowContainer[i]"
                                        (click)='getAvaiableRows([tableName,keys[i]])' name="newRowContainer[i]">

                                        <mat-option *ngFor="let foreignKey of foreignKeyElems"
                                            (click)="saveToContainer(i,foreignKey)" [value]="foreignKey">{{foreignKey}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </form>

                        </div>
                        <!--DATE SECTION-->
                        <ng-template #notDropdownBlock>
                            <div *ngIf="type[i]=='DATE';else notDateBlock" style="margin: 5px; text-align: center;">

                                <form class="form-inline">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input class="form-control" placeholder="yyyy-mm-dd" ngbDatepicker
                                                #d="ngbDatepicker" (keyup)="addElem(i,$event)"
                                                (dateSelect)="saveToContainer(i,($event.year +'-'+ $event.month +'-'+ $event.day).toString())">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary " (click)="d.toggle()"
                                                    type="button" style="margin: 0px;"><i
                                                        class="far fa-calendar-alt"></i></button>

                                            </div>
                                        </div>
                                    </div>
                                </form>

                            </div>
                            <!--DEFAULT SECTION-->
                            <ng-template #notDateBlock>
                                <input class="form-control" (keyup)="inputToContainer(i,$event)">
                            </ng-template>



                        </ng-template>
                    </div>

                </div>

            </form>
        </div>
        <div class="modal-footer">
            <ngb-alert [hidden]="allertHidden" [type]="allertColor" (close)="closeAllert()"
                style="margin-bottom: 12px;">{{ messageToUser }}</ngb-alert>
            <button type="button" class="btn btn-outline-dark" (click)="sendNewElem()">Add</button>

        </div>
    </ng-template>









</div>